> train<-sample(nrow(Sales,2000))
Error in nrow(Sales, 2000) : unused argument(s) (2000)
> train<-sample(1:nrow(Sales),2000,replace=FALSE)
> train
   [1] 1565 3598 3368 1596  324 1386  692 4644  753 2851 2549 4340 2072 4683
  [15] 1076 1763 3646 1585 2876 3023 4612 3874  514 4061 1116 1865 3078 2496
  [29]  285  394  669 3657 2731  471 3690 4478 3901  445   54 2757 1625 3877
  [43] 4351 3936 1309 3012  660 3687  381 1231 1023 1225 2011 4617 1451 1479
  [57] 2168 2916 1626 3165  346 1017 1036 2133 2543 2533 2163 3558 4172 1621
  [71] 3275  796 2895 2898 4036 2449   77 2866 2112 4544 4465 3040 1293 2633
  [85] 4037 4588  582 1902 1914 3303 3290   52  126 2490 4434 1524 1482 4707
  [99] 3780 4648 4245 3883 2417  608 2680 3696  939 1466 1675  688 2661 2836
 [113] 1906 1287 2570 4207 1519 2823 1099 2527 3376 3820 2944  717  222 4322
 [127] 1879 1787 2048 2446 1301 2188 1794 1687 4346 3517  368 1537 3996 2164
 [141]   42  161 2767 2351  120 4703  300 1717 2817 2560 3460 3911 3389 2244
 [155] 1716  733 3206 4270  183 1464 4297  763 1327 4518 2121 3682 4625 2332
 [169] 3066 1731  361 2280 2336  277 1346 1959 3033 3173 2298 4646 2578 2566
 [183] 2131  664 2824 2778  478  319  198   14 2896 3700 3765 1746 2127 2472
 [197] 1641 4277  935 3037 1503 3400 2727 4199 3463 2494 4475  570 1213 2653
 [211] 2644 4290 2370 3477 3804 2081 2520 4265 4508 2838  910 4259 4363 3656
 [225] 2808 2569 1290 4301 3115 4604 1388 4173 1046 3740 2910  894  946 1819
 [239]  299 3935  360 2434 2363 3572  658 2059 3214 3332 1170 1053 1644 3157
 [253] 4423 2926 3508  206 4160 3437 1109 2395  528 1752  371 1723 4550 1956
 [267] 1039 3688  845 2510 4600 2477 2481 2933 3892 3038 3978  897 3029 4433
 [281]  163 3247 4520 3434 2962  135 3000 4424 4718 2135 3715  977 1034 4398
 [295] 3109 2060 3946 4708 4745 1556 1712 2953 4671 4313 2017 3167 2007 1637
 [309] 1736 1370 3987 2846 4096  309  668 3401 2160 2147 3291 1496 1976 3540
 [323] 2158 3031 4308 3387 2281 1265 4522 3452 2050 3830 4102 4239  982 4548
 [337] 1014 2511  730 3651  556 3176 2811 1162 3503 4083 1698  474 3468 2292
 [351] 1994  941 3744 4659 1462  136  447 4594  180 4556 3330  842  758 1533
 [365] 4035   30 1197 1792   13  527 3404 3522  416  992 2182  442 3150  638
 [379]  435 4437 2268 2837 1378 4058 3895 3132  626 1631 2995 2159 4292 3736
 [393] 1506 2514 3091 3658 3196 1984 4457  274 2766 2609 2993  662 2382 3929
 [407] 3912 2980  690  696 2195 4203  264 2703  823 4248  509  937 4418 4559
 [421] 4432 2284  802 2658 4676   99 3995 1148 4352 3443  999  138 3103 3221
 [435] 4311 2790 2548 3727  294 1250 2217 1837 3264 4222 3569 1582  282 4515
 [449] 2667 2003 3722 1926 1487 2440 3073 3534 3549 1583 1177 3608  284 3168
 [463] 1522 1190 4608 4660 1403 2500 3924 3186   82 4232 3028 1941 1136 3243
 [477] 4202 1997 1614 1953 2058 3698 4664  109  453 4474 2148  325 1507 4529
 [491] 2013 4497  524 3619 2753  307 2621 3248 2404 3548 2794 3739 1488 2109
 [505]  495 2554 4171 2901 1701  367 4442 2320 4403 3158 4327 2630 4615 3723
 [519] 3906 1839  616 3027 1012 3006 3979 2607 1492  322 4460 1035 2171 1072
 [533]   44 3392 3130 2939 1795  619  406 2322  634  657  726 3827 2335 4439
 [547]  267 4271 2534  128 2985  314 1599 2090 2734 2466 3570 4236 2741 2480
 [561] 3528 3537 3229  945 3061 4015 3903 2619 4653 4031 2742 4569 3055 2505
 [575]  259 1152 1444  522 2012 2338 3378 1821 4562  158 1226 1101 3271 3044
 [589] 3559 3959 1877 4082 4194  610  352 3093  228 4018 3811 2312 1884 3220
 [603] 3425 2882  868 2253 1823  686 3625 2954 1437 1784 1566 1158 3525 2175
 [617] 1753 3414 1679 2617 1146 4047  179 4103 2918 4741 4022 1739 3411 4714
 [631] 1400  985 2371  655  667 2643 1147 3223 4130  144 3819 1329  165 1208
 [645] 2390 4669 2739 2972 2214  967 4677 3254  853 3361 1262  575 3204 2066
 [659]  801 3836 3054 1762 2976 4656 2526 3334 3045 3458 1003  856 3273 1743
 [673] 1750 2155 3482 4162 4321 4108 2815 1989 4610 3166 1861  553 2170 1105
 [687] 4448 4004 2924 3999 3047 4622 2776 1568 1645  200  956  502 3576 2642
 [701] 3633 1394  765 2948 4568 4654  846 4557 2394 2074 4092 4116 4446 2186
 [715] 3441 4200  551 1842 1878 4011  612 3973 3521 2859 1990 2421 3014 4502
 [729] 4472 3832 1209 2616 4645 2126 1764 1153 1230  691 3382 1515 4667 2294
 [743]  164 4080 3695  645 4053    2 4531 3080 4178 2655  395 2293 3846 1396
 [757] 2546  338 3227 2458 1483 4596 2144 1342   94   74 2423 4039 3309 1038
 [771] 1755 2900  597 3927 3324 1077 2455  516 1960 1702 1922 4316 3956 1948
 [785]   51 1886  247 1493 3919 1237  271 1408  631 3089 3760 4135 1547 1246
 [799]  418  722 2282 2265 3455 3794 2828 1850 1179 1352 4154 1217 2221 3856
 [813] 4517 4095 3689 1269 2398 2241 4345 4614 4365 3742  775 2602  997 4224
 [827]  694 1351  203 3071 2040 1149  526 3828 4668 4577 1449 1229 3111 3267
 [841] 1526 4165  549 1021 1671  185  585 1243 3377 1738 2671 1510 2233  146
 [855]  743 2071 1646  885 4045  257 1704 2229 2654 1399 2288  834 1074 3203
 [869] 1455 3219 1323 2793  976  422 4303  757 4059   36 2425 2979 2721 1715
 [883] 2082 1187 4483 3022 3050 2999 3450 1239  938 1835 3058 1119 4215 2045
 [897] 3634 2589 3159 1588 3198   31 1110 3418 3042   67 2651  948  815  604
 [911]   59 4404 1869 1161 2715 4440 2782 4643  887 3694  581 2856 1718 1972
 [925] 2122 1375  119 2486  755  103 4429 2588 1376 3344  659 1595  504 1409
 [939] 1013 1273  750 3252 2185 1088 4627 2083 3428   10 3652 1689  229 3356
 [953] 2970  821 3726 3562 3327 4738 2975 1048 4480 3494 2914 2605 1121 1103
 [967]   91 2035 2474 4229 3668 1628 2438 2722 2033 1244 2603  532  159 2134
 [981] 1484 3085 2213 1285 4638 2239 2577 3647 1919 3304 1822 2263 4179 3488
 [995]  594 1543 4530 2295 3096 3882 2988  819 3357 2177 4285 2834 3713 1248
[1009] 2917  573 4538  175  178 4078 2002  160 3070  523 2439 1951 2989 2401
[1023] 4020  242 1349 4249 1025 4076 3849  587 2524 4342 1151  457 3989 3914
[1037] 3681 3990 1387 2576 3568  747 3561 2279 4489 1300 3426 2936  558 3179
[1051] 2880 4542 1904 2770 2073 4399   37 3030 3313 2746 4431 3153  426 1709
[1065] 1966 4122 2418  340 2611 1535 3544 1106 1876  226 2184 1880  283 1749
[1079]  379 2016 1697 2580 3730  875 3649 3747 4628 1830 3538 1931 3743 1168
[1093] 1987 3857 2748  671 2855 4452  830 4029  584 1340 3920  680 4046 1875
[1107] 2542 4128 1181 4735 3359  886 2360 2230 4652 2489 2343 3289  225 3933
[1121] 1737 2191 4220 1857 3900  586 3729  217 3296 2652 2450  525 4649 2350
[1135] 2752  592  297 2606 3351 1288 2260  554 1476 1423 3884 3930 1558 3902
[1149] 4226 2720  288 1098 1777  754 4291 4317 2236 4598 2436 1486 1517 1620
[1163] 4252 2541 2601  911 1694 1389 2852  825 4117  770  990 4488 2087 2372
[1177] 2190 1284 3589 4132 4634 3302   68   73 2760  607 1143 3848 3384 4218
[1191] 1069 3094 3473 1775 2528 4382  370 2763 1765 2622 1000  335 2681 4642
[1205] 1895 3255 2441 3897 2947 1672 2305 2356 3817 1297 4449 3591 1063 2677
[1219]  577 1312 4328  101 2001 4744 4153 3504 3308 2592   27 2235 3235  251
[1233] 1114 1985 2735 3660 2240 4093  148  909 2637 1089  833 2632 1357  291
[1247] 3138 2737 2023 1473  955 1405 1295 2276  199 1097 3532 2799 3560  429
[1261]  182 1908 4454 1720 1633  115 2037 1691  208 1345 3577 1882  984 2435
[1275] 3395 3864 1569 3222 2469 4724 3871 3338 4695 3950 2669 2384 2990 3563
[1289]  921 4256 4175 4528 3673 2308 3373  647  130 2130 3712 4357 2359 2869
[1303]  794 3063 1851 2052 3391 3790 1442 3842 2416  308   60 3107  506 2861
[1317]   53 4561   64 3873 3546  215  836 1634 3363 1171 2029 2952 1544 1808
[1331]  143   56  281 1684  499 4580 4715 4620 3616  233 3672 3216 3923 1019
[1345] 1514 1458 1334 4689 4523 1016 4696  683 3262 1938 2302  168 2178 2317
[1359] 2123  609 4458 4700 1589 1815  473 4710  807 3753  915 1247  425 2610
[1373] 3578 2357 4570 1432 3685 2540 2813  536 1658 3277 1011 1657 2504 2193
[1387]  627 3154  756 4217 2518 4109 2672 3250 4504 3278 1050 2873 4367 2850
[1401]  133 1030  171   29 2210 2992 3112 2070 2367 3797 1189 2955 4087 1600
[1415]  674  832 1937 3949 2977 2285 1281 1740 1735  432 2519 3798  273 2042
[1429]   83 4414 4005   75  557 4044  515 4184 3551 1721 1057 1441  362  298
[1443] 2867  492  601 3915 4227 1108 3843 4197  248 3446 2522 4394 1078 3036
[1457] 3205 3980  787 3526 4262 3239  737 3328 2708 3004 4407 1393 1936 3348
[1471] 4633 3253 2014  916 4186  162  767 2107 3123  139 2274 2206 2604  795
[1485] 4241  342 3896 4315 2169 1747 1402 3875 1169 3853 4329 2693 4456 4534
[1499] 3779 3136 4359  131 3405 3342 4578 2368 1760  810 2179 2783 2925 3529
[1513] 3974 1898 1729 2183 1593 3175  632  540 2713 4558 4484 4163 4507  167
[1527] 1223 2532 1635 1864  978 2883 3944 2491 3333 1710  290 1587 2930 3371
[1541] 1950 1236 4584 4023 3595 4702 3814  672  714 4390 1860 3346 3574 4491
[1555] 1663 1655 1224  678 2509 4453  562  243 1100 4555 2018 3209 1570   46
[1569] 1331 2457   20 4276 4533 2529  813  443 1043 4416 1199  113 1010 2949
[1583] 1472   25 2454 2991 4088 3852  507  555 3147 4482 3498 4516 2348 2696
[1597] 4253  606 3402 2365 3294 3300   24  877 4692 4605  850  293 1347 1365
[1611] 3372 1790 2568 3891 2598 4721 4405 3306  448 4411 2785 2827 2986 3280
[1625] 2487 2019 3035 3110  296 2769 4616 3667 3288  452   11 3412 2886 2409
[1639]  925 1252  711 2447 3474 3703 4341  397 2907 2103  900 4264 3837 4665
[1653] 3622 1930 2929 4486 2822 3571 4401 3454 4204  428  972  209  646 3831
[1667] 2194 2777 2507 3339  656 1401  628 3710 2077 2095 1355 1516  234 1096
[1681] 3796 1251  321  137 4296  912 3943 1885 2410   81 3349  204   18 3714
[1695] 1852 4071 2106  501 4211  150 2675  720 2025  695 1081 1234  872 2205
[1709] 2565 1742 4565 1692 3984 4732 3016 2676  892 3183 3451  400 3075 2004
[1723] 3200 2151  702 4546  950 4274 3599 1417 1422 3515 1459 1677 1576 3388
[1737]  177 3648 3650 4364 2098  883 3345 3940  947 1360 2662 2919 1075  961
[1751]  505 4670 1957 2899 3495  816 3492 2096 3674 2430  623 4469 1426 1574
[1765]   87 1203 2465 3731  382 3782 4496  232 1917 1221 4687  591 1132 1532
[1779]  876 4288 3810 3645 1766  637 4462  684 1818 1780 3152  529 2779 3545
[1793]  261 4372   21 1232 4339 2089 1652 2189 2124 2055   57  635 1467 3763
[1807]   65 1145 4027 1847 3024 1820 4139  760 2784 1222 1259  942 1494 1107
[1821]  155 1974  351 3704  102 3581 4549 1923 3611 1713 1245 1811 4420 3417
[1835] 1812 2272 3535 3108  614 2640  345 2376 2833  707 1612 3421  957   26
[1849] 1159 2046 2842 2945 1699 4269 3087 3554  865 1335  568 2334 2906 1856
[1863] 3907 3733  893 1838 3865 1195 4242 3609  252 2287 3776  741 2300 2623
[1877]  286 4713 3276 1605  650 2751 4698  216 2878  356 3808 1341 1412 4147
[1891]  648 4310 2225 2354 1448 2573 2788 1156  326 2069  107 1551 2729  729
[1905] 1058 1317 4722 3013 2849 3868  450 3641 2051   43 1254 3617  250 4513
[1919] 4063 3785 3259 4064 2201 2812 2307 4155 4312  926  994 4075 3967 3701
[1933] 3182 1135  576 3752 3866 2218 1122 1573 3060 4206 3679  262 1772 3898
[1947] 3370 4618 4468 3133 4294 3807 2567 3285 2261 2888 1653 2445  625 2079
[1961] 1523 1909 2714   35  899  781  461  569  790  808 3749 2100 2176  780
[1975] 1184  398 2419  919  762 4701  407 4182 3975 1198  904 1022  310  486
[1989] 1004 3888 1706 1296 3771  784 4651 2674 1870 4473 3566 3635
> dim(train)
NULL
> head(train)
[1] 1565 3598 3368 1596  324 1386
> train<-Sales[sample(1:nrow(Sales),2000,replace=FALSE),]
> head(train)
     opportunity_key introduction diligence proposal negotiation closing
2050      9914004865            0         0        0         209       0
21         991400422            0         0        0           0       0
632      99140042459            0       190        0           0       0
4739     99140042413            0       535        0           0       0
2055      9914004870            0         0        0           0       0
731      99140042571            0       518        0           0       0
       Industry Amount Result
2050     Retail  12000      0
21      Banking  40000      0
632  Technology      0      0
4739     Travel      0      0
2055      Other      0      0
731     Apparel      0      0
> glm_model <- glm(formula=Result ~ introduction + diligence + proposal + negotiation     + closing+ Industry + Amount, data=train, family=binomial)
> Glm_Results <- predict(glm_model,test,type='response')
Error in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels) :
  factor 'Industry' has new level(s) Environmental
> train<-Sales[sample(1:nrow(Sales),1000,replace=FALSE),]
> glm_model <- glm(formula=Result ~ introduction + diligence + proposal + negotiation     + closing+ Industry + Amount, data=train, family=binomial)
> Glm_Results <- predict(glm_model,test,type='response')                                                                                       Error in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels) :
  factor 'Industry' has new level(s) Engineering, Environmental, Pharmaceuticals
> train<-Sales[sample(1:nrow(Sales),3000,replace=FALSE),]                                                                                      > glm_model <- glm(formula=Result ~ introduction + diligence + proposal + negotiation     + closing+ Industry + Amount, data=train, family=binomial)
> Glm_Results <- predict(glm_model,test,type='response')                                                                                       > threshold <- 0.5
> pred      <- factor( ifelse(Glm_Results > threshold, "1", "0") )
> table(test1,pred)
     pred
test1    0    1
    0 1329   53
    1  490  128
> (1329+128)/(1329+53+490+128)
[1] 0.7285
>
